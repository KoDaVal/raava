@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

/* Variables CSS para modo oscuro y claro */
:root {
  --bg-color: #000;
  --sidebar-bg: #0a0a0a;
  --panel-bg: #0a0a0a;
  --chat-bg: #121212;
  --text-color: #e0e0e0;
  --link-color: #bbbbbb;
  --message-bg: #1e1e1e;
  --message-user-bg: #2d2d2d;
  --button-bg: #1e1e1e;
  --border-color: #1e1e1e;
  --hover-color: #292929;
  --button-text-color: #cccccc;
  --avatar-name-color: #f0f0f0;
  --quote-color: #aaaaaa;
   --header-bg: var(--chat-bg); /* guardadox seguro */
  --settings-modal-bg: rgba(0, 0, 0, 0.7); /* Nuevo */
  --settings-content-bg: #1e1e1e; /* Nuevo */
  --settings-border-color: #333; /* Nuevo */
  --settings-text-color: #e0e0e0; /* Nuevo */
  --settings-nav-hover: #292929; /* Nuevo */
  --switch-bg: #555; /* Nuevo */
  --switch-checked-bg: #8a2be2; /* Nuevo */
  --slider-bg: #f2f2f2; /* Nuevo */
  --select-bg: #2d2d2d; /* Nuevo */
  --select-border: #444; /* Nuevo */
}

body.light-mode {
  --bg-color: #f2f2f2;
  --sidebar-bg: #ffffff;
  --panel-bg: #ffffff;
  --chat-bg: #ffffff;
  --text-color: #111;
  --link-color: #333;
  --message-bg: #dddddd;
  --message-user-bg: #c1c1c1;
  --button-bg: #dddddd;
  --border-color: #d1d1d1;
  --hover-color: #c1c1c1;
  --button-text-color: #555;
  --avatar-name-color: #333;
  --quote-color: #555;
  --header-bg: #ffffff; /* Ahora color del header del chat central */
  --settings-modal-bg: rgba(0, 0, 0, 0.5); /* Nuevo */
  --settings-content-bg: #f2f2f2; /* Nuevo */
  --settings-border-color: #d1d1d1; /* Nuevo */
  --settings-text-color: #111; /* Nuevo */
  --settings-nav-hover: #e0e0e0; /* Nuevo */
  --switch-bg: #bbb; /* Nuevo */
  --switch-checked-bg: #8a2be2; /* Nuevo */
  --slider-bg: #ffffff; /* Nuevo */
  --select-bg: #e0e0e0; /* Nuevo */
  --select-border: #ccc; /* Nuevo */
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Inter', sans-serif;
  font-size: 12px;
  background-color: var(--bg-color);
  color: var(--text-color);
  height: 100vh;
  display: flex; /* Cambiado para que el main-container ocupe toda la altura */
  transition: background 0.3s, color 0.3s;
  overflow: hidden; /* Evita el scroll del body principal */
}

/* Contenedor principal para la barra lateral, chat y info-panel */
.main-container {
  display: flex;
  flex: 1; /* Ocupa el espacio restante después del header si hubiera uno fuera */
  overflow: hidden; /* Asegura que el scroll se maneje internamente */
  width: 100%; /* Asegura que ocupe el 100% del ancho del body */
}

.sidebar {
  background-color: var(--sidebar-bg);
  width: 220px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid var(--border-color);
  flex-shrink: 0; /* Evita que la sidebar se encoja */
  transition: width 0.3s ease; /* Transición para el ancho */
}

.sidebar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px; /* Espacio debajo del encabezado de la barra lateral */
  padding-right: 10px; /* Ajuste para dar espacio al botón */
}

/* Estilo para el logo de Raava en la sidebar */
.sidebar-raava-logo {
  width: 50px; /* Tamaño más pequeño */
  height: auto;
  align-self: center; /* Centra el logo en la sidebar */
  transition: width 0.3s ease;
}

.hide-sidebar-btn {
  background: none;
  border: none;
  color: var(--link-color); /* Color que se adapte al tema */
  font-size: 20px;
  cursor: pointer;
  transition: color 0.2s, background-color 0.2s;
  padding: 5px;
  border-radius: 4px;
}

.hide-sidebar-btn:hover {
  color: var(--text-color);
  background-color: var(--hover-color);
}


.sidebar a,
#premium-button {
  color: var(--link-color);
  text-decoration: none;
  font-size: 14px;
  margin-bottom: 18px;
  display: block;
  padding: 6px 0;
  border-radius: 4px;
  transition: all 0.25s ease-in-out;
  cursor: pointer;
}

.sidebar a:hover,
#premium-button:hover {
  background-color: var(--hover-color);
  color: var(--text-color);
  padding-left: 8px;
}

/* --- ESTILOS PARA LA BARRA LATERAL COLAPSADA --- */
.sidebar.collapsed {
    width: 60px; /* Ancho reducido cuando está colapsada */
    align-items: center; /* Centrar los iconos */
    padding: 20px 0; /* Ajustar padding */
}

.sidebar.collapsed .sidebar-header {
    justify-content: center; /* Centrar el logo cuando está colapsado */
    margin-bottom: 30px; /* Mantener espacio */
    padding-right: 0; /* Eliminar padding cuando está colapsada */
}

.sidebar.collapsed .sidebar-raava-logo {
    width: 40px; /* Un poco más pequeño cuando está colapsado */
}

.sidebar.collapsed .hide-sidebar-btn {
    /* El botón sigue siendo visible, pero el icono cambia para indicar "expandir" */
    /* No lo ocultamos, simplemente ajustamos su posición si es necesario */
    font-size: 20px; /* Asegura que el icono sea visible */
}

/* Ocultar texto y mostrar solo iconos cuando la sidebar está colapsada */
.sidebar.collapsed a,
.sidebar.collapsed #premium-button {
    text-align: center;
    padding: 6px 0;
    font-size: 0; /* Ocultar el texto */
    overflow: hidden; /* Asegurarse de que el texto no se vea */
    white-space: nowrap;
    width: 100%; /* Asegurar que ocupe todo el ancho disponible para el hover */
}

.sidebar.collapsed a i,
.sidebar.collapsed #premium-button i {
    font-size: 20px; /* Mostrar solo el icono */
    display: block; /* Asegurar que el icono esté visible */
    margin: 0 auto; /* Centrar el icono */
}

/* Ajustar el contenedor principal cuando la sidebar está colapsada */
.main-container.sidebar-collapsed {
    /* Si tu layout usa flex-grow o similar, el chat-main-section se expandirá. */
    /* No se necesita CSS aquí a menos que tengas un layout muy específico que dependa del ancho de la sidebar. */
}

/* --- FIN ESTILOS BARRA LATERAL COLAPSADA --- */


/* --- NUEVOS ESTILOS PARA EL CONTENEDOR CENTRAL (HEADER + CHAT) --- */
.chat-main-section {
    flex: 1; /* Para que ocupe el espacio restante horizontalmente */
    display: flex;
    flex-direction: column; /* Apila el header y el chat-area verticalmente */
    background-color: var(--chat-bg); /* Fondo para toda la sección central */
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 20px;
  background-color: var(--header-bg);
  border-bottom: 1px solid var(--border-color);
  height: 60px;
  flex-shrink: 0;
}

.header-left {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-color);
  display: flex; /* Para alinear el texto si se añade un logo aquí */
  align-items: center;
  gap: 10px;
}

/* Si se añade un logo en el header, este sería su estilo */
.header-raava-logo {
  width: 30px; /* Tamaño del logo en el header */
  height: auto;
}

.header-right {
  position: relative;
  display: flex;
  align-items: center;
}

.profile-pic {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  object-fit: cover;
  border: 2px solid var(--border-color);
  transition: border-color 0.2s;
}

.profile-pic:hover {
  border-color: var(--link-color);
}

.settings-menu {
  position: absolute;
  top: 50px; /* Debajo de la foto de perfil */
  right: 0;
  background-color: var(--panel-bg);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  width: 180px;
  z-index: 10;
  display: none; /* Oculto por defecto */
}

.settings-menu.active {
  display: block; /* Muestra el menú cuando tiene la clase 'active' */
}

.settings-menu-item {
  padding: 10px 15px;
  color: var(--text-color);
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.settings-menu-item:hover {
  background-color: var(--hover-color);
}

/* NUEVOS ESTILOS PARA EL MODAL DE AJUSTES */
.settings-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--settings-modal-bg);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.settings-modal.active {
    opacity: 1;
    visibility: visible;
}

.settings-content {
    background-color: var(--settings-content-bg);
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    width: 90%;
    max-width: 700px;
    max-height: 90vh; /* Para que el modal no sea más alto que la ventana */
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Asegura que el contenido interno se desplace si es necesario */
}

.settings-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid var(--settings-border-color);
}

.settings-header h3 {
    margin: 0;
    color: var(--settings-text-color);
    font-size: 18px;
}

.close-settings-btn {
    background: none;
    border: none;
    font-size: 28px;
    color: var(--settings-text-color);
    cursor: pointer;
    line-height: 1;
}

.settings-body {
    display: flex;
    flex: 1; /* Ocupa el espacio restante */
    min-height: 0; /* Permite que el flex-child se encoja */
}

.settings-nav {
    width: 200px;
    padding: 15px 0;
    border-right: 1px solid var(--settings-border-color);
    flex-shrink: 0; /* No se encoge */
    overflow-y: auto; /* Scroll para la navegación si es muy larga */
}

.settings-nav-item {
    padding: 10px 20px;
    color: var(--settings-text-color);
    cursor: pointer;
    transition: background-color 0.2s;
    font-size: 14px;
}

.settings-nav-item:hover,
.settings-nav-item.active {
    background-color: var(--settings-nav-hover);
}

.settings-pane {
    flex: 1; /* Ocupa el espacio restante */
    padding: 20px;
    overflow-y: auto; /* Scroll para el panel de contenido si es muy largo */
}

.setting-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--settings-border-color);
}

.setting-row:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.setting-row label {
    font-size: 14px;
    color: var(--settings-text-color);
    font-weight: 600;
}

.setting-row select,
.setting-row input[type="text"] {
    background-color: var(--select-bg);
    color: var(--settings-text-color);
    border: 1px solid var(--select-border);
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 14px;
    appearance: none; /* Elimina estilos por defecto del select */
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    width: 150px; /* Ancho fijo para selects */
}

.voice-controls {
    display: flex;
    gap: 10px;
    align-items: center;
}

.voice-controls button {
    background-color: var(--button-bg);
    color: var(--button-text-color);
    border: 1px solid var(--border-color);
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s;
    font-size: 12px;
}

.voice-controls button:hover {
    background-color: var(--hover-color);
    color: var(--text-color);
    border-color: var(--text-color);
}

/* Estilos para el switch (toggle) */
.switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 20px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--switch-bg);
    transition: .4s;
    border-radius: 20px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 2px;
    bottom: 2px;
    background-color: var(--slider-bg);
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: var(--switch-checked-bg);
}

input:checked + .slider:before {
    transform: translateX(20px);
}
/* FIN NUEVOS ESTILOS MODAL DE AJUSTES */

/* ESTILOS DE CHAT */
/* MODIFICADO: Styles for the chat content area */
.chat-area {
    flex: 1; /* Permite que ocupe todo el espacio vertical disponible */
    display: flex; /* Habilita Flexbox */
    flex-direction: column; /* Organiza los elementos hijos en columna */
    position: relative; /* CRÍTICO: Permite posicionamiento absoluto para sus hijos */
    overflow: hidden; /* CRÍTICO: Asegura que el contenido interno no desborde y que el scroll se gestione dentro */
}

/* MODIFICADO: Styles for the messages container */
.messages {
    flex-grow: 1; /* CRÍTICO: Ocupa todo el espacio disponible que el área de entrada deja libre */
    overflow-y: auto; /* CRÍTICO: Habilita el scroll vertical cuando los mensajes exceden el alto */
    padding: 20px; /* Asegura un padding base. Ajusta si ya tenías otro padding. */
    padding-bottom: 90px; /* CRÍTICO: Espacio adicional en la parte inferior para que los mensajes no queden ocultos detrás de la barra de entrada fija. Puedes ajustar este valor si tu barra de entrada es más alta o más baja. */
    display: flex; /* Habilita Flexbox para organizar los mensajes */
    flex-direction: column; /* Apila los mensajes verticalmente */
    gap: 10px; /* Espacio entre mensajes */
}

/* MODIFICADO: Styles for the fixed input area */
.chat-input-area-container {
    position: absolute; /* CRÍTICO: Fija este elemento respecto a su padre posicionado (.chat-area) */
    bottom: 0; /* Lo ancla a la parte inferior */
    left: 0; /* Lo ancla a la izquierda */
    right: 0; /* Lo ancla a la derecha, asegurando que ocupe todo el ancho */
    width: 100%; /* Explicitly set width to 100% */
    background-color: var(--chat-bg); /* Use chat background for consistency */
    padding: 15px 20px; /* Consistent padding */
    border-top: 1px solid var(--border-color); /* Separator line */
    display: flex;
    align-items: flex-end; /* Align items to the bottom, useful for textarea growth */
    gap: 10px; /* Space between textarea and buttons */
    z-index: 100; /* Ensure it stays on top of messages */
}

.user-message,
.bot-message {
  display: flex;
  margin-bottom: 10px;
  align-items: flex-end; /* Alinea los mensajes con el avatar en la parte inferior */
}

.message-content {
  background-color: var(--message-bg);
  padding: 10px 15px;
  border-radius: 10px;
  max-width: 70%;
  position: relative; /* Para el botón de audio */
  word-wrap: break-word; /* Asegura que el texto largo se rompa */
}

.user-message .message-content {
  background-color: var(--message-user-bg);
  margin-left: auto; /* Empuja el mensaje del usuario a la derecha */
}

.bot-message .message-content {
  margin-right: auto; /* Empuja el mensaje del bot a la izquierda */
}

.message-avatar {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  object-fit: cover;
  margin: 0 10px; /* Espacio alrededor del avatar */
  align-self: flex-end; /* Alinea el avatar a la parte inferior del contenedor del mensaje */
}

.user-message .message-avatar {
  order: 2; /* Coloca el avatar del usuario a la derecha del mensaje */
}

.bot-message .message-avatar {
  order: 1; /* Coloca el avatar del bot a la izquierda del mensaje */
}

.message-audio-button {
    background: none;
    border: none;
    color: var(--link-color);
    cursor: pointer;
    margin-left: 10px;
    font-size: 16px;
    padding: 0; /* Elimina padding para ajustar el ícono */
    position: absolute;
    bottom: 5px; /* Ajusta la posición vertical */
    right: 5px; /* Ajusta la posición horizontal */
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px; /* Tamaño del botón */
    height: 24px; /* Tamaño del botón */
    border-radius: 50%;
    background-color: rgba(0, 0, 0, 0.2); /* Fondo sutil para el botón */
}

.message-audio-button:hover {
    color: var(--text-color);
    background-color: rgba(0, 0, 0, 0.4);
}

/* Estilo para el input de texto */
#user-input {
  flex: 1;
  background-color: var(--message-bg);
  border: 1px solid var(--border-color);
  border-radius: 20px;
  padding: 10px 15px;
  color: var(--text-color);
  font-family: 'Inter', sans-serif;
  font-size: 14px;
  resize: none; /* Deshabilita el redimensionamiento manual */
  min-height: 40px; /* Altura mínima */
  max-height: 200px; /* Altura máxima antes de que aparezca el scroll interno */
  overflow-y: hidden; /* Oculta el scroll por defecto, manejado por JS */
}

#user-input::placeholder {
  color: var(--link-color);
}

.send-button, .attach-button {
  background-color: var(--button-bg);
  color: var(--button-text-color);
  border: 1px solid var(--border-color);
  border-radius: 50%; /* Botón circular */
  width: 40px; /* Tamaño del botón */
  height: 40px; /* Tamaño del botón */
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.2s, color 0.2s, border-color 0.2s;
  flex-shrink: 0; /* Evita que el botón se encoja */
}

.send-button:hover, .attach-button:hover {
  background-color: var(--hover-color);
  color: var(--text-color);
  border-color: var(--text-color);
}

.send-button svg {
  width: 20px; /* Tamaño del icono de enviar */
  height: 20px;
}

/* Contenedor para mostrar el archivo seleccionado */
.file-display {
  display: flex;
  align-items: center;
  gap: 10px;
  background-color: var(--message-bg);
  padding: 8px 12px;
  border-radius: 8px;
  margin-top: 10px;
  width: fit-content;
  max-width: 80%;
  word-break: break-all; /* Para nombres de archivo largos */
  display: none; /* Oculto por defecto, visible con JS */
}

.file-display i {
  color: var(--link-color);
}

.file-name {
  color: var(--text-color);
  font-size: 12px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.clear-file {
  background: none;
  border: none;
  color: var(--link-color);
  font-size: 16px;
  cursor: pointer;
  margin-left: auto; /* Empuja el botón a la derecha */
}

.clear-file:hover {
  color: var(--text-color);
}


/* Estilos para el panel de información (derecha) */
.info-panel {
  background-color: var(--panel-bg);
  width: 220px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  border-left: 1px solid var(--border-color);
  flex-shrink: 0; /* Evita que el panel se encoja */
}

.info-panel h4 {
  color: var(--text-color);
  margin-bottom: 20px;
  font-size: 14px;
}

.menu-option {
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--link-color);
  text-decoration: none;
  font-size: 14px;
  margin-bottom: 15px;
  padding: 8px 12px;
  border-radius: 6px;
  transition: background-color 0.2s, color 0.2s;
  cursor: pointer;
  width: 100%; /* Para que ocupe todo el ancho disponible */
}

.menu-option i {
  font-size: 16px;
}

.menu-option:hover {
  background-color: var(--hover-color);
  color: var(--text-color);
}

.avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  margin-top: 30px;
  border: 3px solid var(--border-color); /* Borde alrededor del avatar */
  cursor: pointer; /* Hace que el avatar sea clicable */
  transition: border-color 0.2s;
}

.avatar:hover {
  border-color: var(--link-color);
}

.name {
  font-size: 16px;
  font-weight: 600;
  color: var(--avatar-name-color);
  margin-top: 10px;
}

.quote {
  font-size: 12px;
  color: var(--quote-color);
  text-align: center;
  margin-top: 5px;
  font-style: italic;
}

.start-button {
  background-color: #8a2be2; /* Azul violeta */
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 20px;
  font-size: 14px;
  cursor: pointer;
  margin-top: 20px;
  transition: background-color 0.3s ease;
  width: 100%;
  text-align: center;
}

.start-button:hover {
  background-color: #7a1ed1;
}

.start-button:disabled {
    background-color: #6a6a6a;
    cursor: not-allowed;
}

/* Estilos para el indicador de escritura */
.typing-indicator {
  display: flex; /* Use flexbox for horizontal alignment of dots */
  align-self: flex-start; /* Explicitly align the indicator itself to the left */
  align-items: center; /* Vertically center the dots within the indicator */
  justify-content: center; /* Horizontally center the dots within the indicator */
  
  background-color: var(--message-bg);
  padding: 10px 15px;
  border-radius: 10px;
  width: fit-content;
  max-width: 70%; /* Keep max-width for consistency */
  margin-right: auto; /* Ensure it stays left-aligned if parent doesn't handle flex-start */
  opacity: 0;
  transition: opacity 0.3s ease-in-out;
}

.typing-indicator span {
  width: 8px;
  height: 8px;
  background-color: var(--text-color);
  border-radius: 50%;
  margin: 0 2px;
  animation: blink 1.4s infinite ease-in-out;
}

.typing-indicator span:nth-child(2) {
  animation-delay: 0.2s;
}

.typing-indicator span:nth-child(3) {
  animation-delay: 0.4s;
}

@keyframes blink {
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
}

/* Nuevo estilo para el botón "Iniciar mente" cuando el archivo de info esté listo */
.start-button.info-ready {
  background-color: #28a745; /* Un verde vibrante */
}

.start-button.info-ready:hover {
  background-color: #218838;
}


/* Estilos para la barra de desplazamiento personalizada */
/* Para navegadores basados en Webkit (Chrome, Safari, Edge, Opera) */
.messages::-webkit-scrollbar {
    width: 8px; /* Ancho de la barra de desplazamiento vertical */
    height: 8px; /* Altura de la barra de desplazamiento horizontal (si aplica) */
}

.messages::-webkit-scrollbar-track {
    background: var(--chat-bg); /* Fondo de la pista de la barra de desplazamiento */
    border-radius: 10px; /* Bordes redondeados para la pista */
}

.messages::-webkit-scrollbar-thumb {
    background-color: #8a2be2; /* Color del "pulgar" de la barra de desplazamiento */
    border-radius: 10px; /* Bordes redondeados para el pulgar */
    border: 2px solid var(--chat-bg); /* Borde para que parezca más delgado y separado */
}

.messages::-webkit-scrollbar-thumb:hover {
    background-color: #7a1ed1; /* Color del "pulgar" al pasar el ratón */
}
